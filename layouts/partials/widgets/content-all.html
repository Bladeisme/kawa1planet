{{ $class1 := "" }}
{{ $isPage := or (eq .Kind "page") (eq .Section "about") }}
{{ $langNow := .Lang }}
{{ $isMultiLingual := and (ne .Site.Language.Weight 1) (and .Site.IsMultiLingual (not .Site.Params.Site.OnlyOneLang)) }}
{{ if $isPage }}
    {{ $class1 = "content-root" }}
{{ else if eq .Kind "taxonomy" }}
    {{ $class1 = "taxo-body" }}
{{ else if eq .Kind "term" }}
    {{ $class1 = "terms-body" }}
{{ end }}

<div class="{{ $class1 }}">
    <div class="long">
        <button class="tosides-1 text-wbd">
            <i class="fa fa-arrow-right"></i>
        </button>
        <button class="tosides-2 text-wbd">
            <i class="fa fa-arrow-left"></i>
        </button>
        <button class="toup text-wbd">
            <i class="fa fa-arrow-up"></i>
        </button>
    </div>
    {{ if $isPage }}
        <div class="content">
            <div class="content-self">
                {{ .Content }}
            </div>
            {{ if eq .Kind "page" }}
                <div class="tags">
                    {{ range $tag := .Params.tags }}
                    <span class="down-type-item">
                        <div class="type-text">
                            <a href='{{ if $isMultiLingual }}
                                        {{ $langNow | relURL}}/tags/{{ $tag | urlize }}
                                    {{ else }}
                                        {{ "tags/" | relURL }}{{ $tag | urlize }}
                                    {{ end }}'>
                                <i class="fa fa-tag"></i> {{ . }}
                            </a>
                        </div>
                    </span>
                    {{ end }}
                </div>
            {{ end }}
        </div>
        {{ if eq .Kind "page" }}
            {{ if or .PrevInSection .NextInSection }}
                <div class="pre-next">
                    {{ partial "widgets/pre-next.html" . }}
                </div>
            {{ end }}
        {{ end }}
    {{ else if eq .Kind "term" }}
        <div class="terms-row">
            {{ range .Pages }}
            <div class="terms-root">
                
                {{ partial "widgets/post-card.html" . }}
            </div>
            {{ end }}
        </div>
    {{ else if eq .Kind "taxonomy" }}
        <div class='taxo-row {{ if eq .Section "tags" }}taxo-row-tag{{ end }}'>
            {{ if eq .Section "tags" }}
                {{ partial "widgets/tag-card.html" . }}
            {{ else }}
                {{ partial "widgets/category-card.html" . }}
            {{ end }}
        </div>
    {{ end }}
</div>
{{ if $isPage }}
    {{ if or .Site.Menus.sponsor .Site.Params.waline.enable }}
        <div class="content-last">
            {{ if .Site.Menus.sponsor }}
                <button class="aixin content-last-item efct-button">
                    <i class="fa fa-heart"></i>
                </button>
            {{ end }}
            {{ if .Site.Params.waline.enable }}
                <button class="pinglun content-last-item efct-button">
                    <i class="fa fa-comment"></i>
                </button>
            {{ end }}
        </div>
    {{ end }}
    
    <div id="waline"></div>
    <script type="module">
        import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
  
        init({
          el: '#waline',
          serverURL: 'https://planetwaline.vercel.app',
          lang: 'zh-CN',
        });
      </script>

      <style>
        .waline-container {
            background-color: transparent;
            border-radius: var(--card-border-radius);
            box-shadow: var(--shadow-l1);
            padding: 2%; /*缩小边距*/
        
        }
        .waline-container .vcount {
            color: var(--card-text-color-main);
        }
        
        :root{
          /* 主题色 */
          --waline-font-size: 1rem ;
          --waline-theme-color: #154c47;
          --waline-active-color: #335c5f;
          --waline-color: #154c47;
          --waline-bg-color: transparent;
          --waline-bgcolor-light: rgba(200, 200, 200, 0.4);
          --waline-border-color: #154c47;
          --waline-disable-bgcolor: #FAF9F7;
          --waline-avatar-size:5rem !important;
          --waline-m-avatar-size:calc(var(--waline-avatar-size)*9/13) !important; 
          --waline-badge-color:rgba(5, 150, 148, 0.425) ;
          --waline-badge-font-size: 0.45em ;
          --waline-info-bgcolor: #f8f8f8 ;
          --waline-info-color:#999 ;
          --waline-info-font-size: 0.625rem ;
          --waline-border: 1px solid var(--waline-border-color);
          --waline-avatar-radius: 50%;
        }

 /*夜间模式*/
         :root[mode="dark"] {
            --waline-theme-color: #acc6e0;
            --waline-white: #34495e; /*按键字体颜色*/
            --waline-active-color: #335c5f;
            --waline-light-grey: #666;
            --waline-dark-grey: #5c8c88; /*ID颜色*/
            --waline-badge-color: #acc6e0;

            /* 布局颜色 */
            --waline-text-color: rgba(255, 255, 255, 0.7);
            --waline-bgcolor: transparent;
            --waline-bgcolor-light: #66696b;/*行内代码块颜色*/
            --waline-border-color: #5c8c88;
            --waline-disable-bgcolor: #444;
            --waline-disable-color: #272727;

            /* 特殊颜色 */
            --waline-bq-color:  #9B9C9C; /*quote*/

            /* 其他颜色 */
            --waline-info-bgcolor: #acc6e0;
            --waline-info-color: #9B9C9C;
        }

        .comment-waline{
          /*
          margin-top: 40px;
          position:relative;
          float: none;
          display: inline;
          padding: 10px;
          */
          background-color: transparent;
          margin-top: 18px;
          padding-top: 25px;
          padding-bottom: 40px;
          padding-left: 40px;
          padding-right: 40px;
          font-weight: 300;
          line-height: 1.8;
        
          /*
          border-left: 1px solid rgba(0,0,0,0.1);
          border-right: 1px solid rgba(0,0,0,0.1);
          */
        }
        .comment-underline {
          display: inline-block;
          margin-top: 10px;
          margin-bottom: 0px;
          width: 50px;
          border-bottom: 3px solid #f0485388;
        }
        </style>
        
{{ end }}
